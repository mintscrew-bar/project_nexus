# Discord 봇 중복 기능 확인 결과

## 확인 일시
2026-02-12

## 확인 결과 요약

### ✅ 기존에 구현만 되어 있고 호출 코드가 없었던 함수들

다음 함수들은 `DiscordVoiceService`에 이미 구현되어 있었지만, 실제로 호출하는 코드가 없었습니다:

1. **`createRoomChannels`** - 룸별 카테고리 및 팀별 음성채널 생성
   - 기존: 구현만 되어 있음
   - 추가: `RoomService.createRoom()`에서 호출 코드 추가

2. **`handleTeamAssignment`** - 팀 구성 완료 시 팀별 채널 배치
   - 기존: 구현만 되어 있음
   - 추가: `AuctionService.completeAuction()`, `SnakeDraftService.completeDraft()`에서 호출 코드 추가

3. **`deleteRoomChannels`** - 토너먼트 완료 시 채널 삭제
   - 기존: 구현만 되어 있음
   - 추가: `MatchService.checkBracketCompletion()`에서 호출 코드 추가

### ✅ 새로 추가한 함수들 (중복 없음)

1. **`findAndAssignLobbyChannel`** - 외부 대기실 스캔 및 할당
   - 목적: 외부에 미리 만들어져 있는 대기실을 찾아 할당
   - 중복 없음: `createRoomChannels`는 룸 내부 대기실을 생성하는 용도로 목적이 다름

2. **`assignCaptainRole` / `removeCaptainRole`** - 팀장 역할 부여/제거
   - 중복 없음: 완전히 새로운 기능

3. **`moveAllToLobby`** - 토너먼트 완료 시 모든 참가자를 대기실로 이동
   - 중복 없음: 완전히 새로운 기능
   - 내부 로직: 룸의 내부 대기실을 우선 사용하고, 없으면 외부 대기실을 찾음

## 대기실 관련 중복 처리

### 두 가지 대기실 개념

1. **내부 대기실** (`createRoomChannels`에서 생성)
   - 룸 카테고리 내부에 생성되는 대기실
   - `numTeams >= 3`일 때 자동 생성
   - 룸이 삭제되면 함께 삭제됨

2. **외부 대기실** (`findAndAssignLobbyChannel`에서 찾음)
   - 서버에 미리 만들어져 있는 공용 대기실
   - 여러 룸이 공유 가능
   - 룸 삭제와 무관하게 유지됨

### 처리 방식

- **룸 생성 시**: 외부 대기실을 찾아 할당 (참고용, 현재는 사용하지 않음)
- **토너먼트 완료 시**: 
  1. 룸의 내부 대기실이 있으면 우선 사용
  2. 없으면 외부 대기실을 찾아 사용
  3. 둘 다 없으면 경고 로그 출력

## 결론

✅ **중복 없음**: 기존 함수들은 구현만 되어 있었고 호출 코드가 없었으므로, 호출 코드를 추가한 것은 정상적인 작업입니다.

✅ **새 기능 추가**: 새로 추가한 함수들은 기존 기능과 중복되지 않으며, 각각 고유한 목적을 가지고 있습니다.

✅ **대기실 처리**: 내부/외부 대기실을 구분하여 처리하도록 구현되어 있어 중복 없이 동작합니다.
